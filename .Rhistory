#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time, data$caseR, type="l", main= "Resistant cases over time", xlab="Time", ylab="cases")
plot(data$time,data$caseS, type="l", main= "Susceptible cases over time", xlab="Time", ylab="cases")
plot(data$time,data$caseS, type="l", main= "New susceptible cases over time", xlab="Time", ylab="cases")
lines(data$time, data$caseR, type="l", main= "New resistant cases over time", xlab="Time", ylab="cases")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New susceptible cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases")
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend("topleft", "(x,y)", pch = 1, title = "topleft, inset = .05",
inset = .05)
legend("topleft", "(x,y)", lty=c(1,2), col="black", "red"), pch = 1)
legend("topleft", "(x,y)", lty=c(1,2), col=c("black", "red"), pch = 1)
legend("topleft", labels = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend("topleft", labels = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
legend("topleft", legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
legend(0.5,100, legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
legend(0.5,900,border="NULL", legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900,border="NULL", legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
legend(0.5,900,box.lty=NULL, border=NULL, legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900,box.lty=NULL, border=NULL, legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
legend(0.5,900,fill=NULL,box.lty=NULL, border=NULL, legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900,fill=NULL,box.lty=NULL, border=NULL, legend = c("Susceptible cases left", "New resistant cases"), lty=c(1,2), col=c("black", "red"), pch = 1)
legend(0.5,900, lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
legend(700,900, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(700,900, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
legend(0.5,0.5, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,0.5, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
legend(10,10, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(10,10, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,10, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
dev.off
dev.off()
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Health","Defense"),lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
legend(0.5,900, c("Health","Defense"),bty = "n",lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Health","Defense"),bty = "n",lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Health","Defense"),bty = "n",lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"),text.width=c(1,0.25,1))
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Health","Defense"),bty = "n",lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"),x.intersp=2)
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Health","Defense"),bty = "n",lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"),x.intersp=0.5)
legend(0.5,900, c("Health","Defense"),bty = "n",lty=c(1,1), lwd=c(2.5,2.5),col=c("blue","red"),adj = c(0, .6))
dev.off()
dev.off()
dev.off()
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), lwd=c(2.5,2.5),col=c("blue","red"),
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), lwd=c(2.5,2.5),col=c("blue","red"),
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), lwd=c(2.5,2.5),col=c("blue","red"),
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), lwd=c(2.5,2.5),col=c("blue","red"),
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("blue","red"),
)
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("blue","red"))
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("blue","red"))
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(0.5,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
legend(10,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(10,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(30,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(25,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(20,900, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
data = data.frame(cbind(time=c(1:250), caseR=NA))
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:30], cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:30],1-cumsum(data$caseR/1000)[1:30],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:30],data$caseS[1:30], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:30], data$caseR[1:30], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(15,1000, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
f
data = data.frame(cbind(time=c(1:250), caseR=NA))
# BINOMIAL PROCESS OF DEVELOPING RESISTANCE OVER TIME
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
# PLOT DATA
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of resistant BSI over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:min(f)], cumsum(data$caseR/1000)[1:min(f)],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:min(f)],1-cumsum(data$caseR/1000)[1:min(f)],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:min(f)],data$caseS[1:min(f)], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:min(f)], data$caseR[1:min(f)], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(15,1000, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
data = data.frame(cbind(time=c(1:250), caseR=NA))
# BINOMIAL PROCESS OF DEVELOPING RESISTANCE OVER TIME
n = 1000
t  = 1
while(n > 0){
data$caseR[t] = sum(rbinom(n, 1, p=0.01*t))
data$p[t] = 0.01*t
n = n - data$caseR[t]
data$caseS[t] = n
print(n)
t = t+1
#print(data$p)
}
# PLOT DATA
par(mfrow=c(2,2))
p = plot(data$time[!is.na(data$caseR)] , data$p[!is.na(data$caseR)],xlab="time", ylab="p", type=
"l", main="Probability of developing resistance over time")
f = which(is.na(data$caseR))
data$caseR[f] = 0
data$caseS[f] = 0
#plot(data$time, cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Resistant")
#plot(data$time,1-cumsum(data$caseR/1000),type="l",xlab="Time", ylab="Fraction of patients",main="Susceptible")
plot(data$time[1:min(f)], cumsum(data$caseR/1000)[1:min(f)],type="l",xlab="Time", ylab="Fraction of patients", main="Resistant")
plot(data$time[1:min(f)],1-cumsum(data$caseR/1000)[1:min(f)],type="l",xlab="Time", ylab="Fraction of patients", main="Susceptible")
plot(data$time[1:min(f)],data$caseS[1:min(f)], type="l", main= "New cases over time", xlab="Time", ylab="cases")
lines(data$time[1:min(f)], data$caseR[1:min(f)], type="l", lty=2,main= "New resistant cases over time", xlab="Time", ylab="cases",col="red")
legend(15,1000, c("Susceptible cases left","New resistant cases"),bty = "n",lty=c(1,2), col=c("black","red"))
for(i in 1:10){
inf = rbinom(1,1,0.01)
inf_all = c(inf,inf_all)
}
inf_all=NULL
for(i in 1:10){
inf = rbinom(1,1,0.01)
inf_all = c(inf,inf_all)
}
inf_all
inf_all=NULL
for(i in 1:10){
inf = rbinom(100,1,0.1)
inf_all = c(inf,inf_all)
}
inf_all=NULL
inf_all=NULL
for(i in 1:10){
inf = rbinom(100,1,0.1)
inf_all = c(inf,inf_all)
}
inf_all
inf_all=NULL
for(i in 1:10){
inf = sum(rbinom(100,1,0.1))
inf_all = c(inf,inf_all)
}
inf_all
plot(cumsum(inf_all)
)
plot(cumsum(inf_all), type="l")
setwd("~/Dropbox/RGNOSIS/Data/SATURN/Yehuda/")
